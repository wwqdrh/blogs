---
title: '2024-01-09'
date: '2024-01-09'
tags: ['每日一题']
draft: false
summary: 每日一题
---

## 算法

给定一个整数数组，寻找满足数组和大于target的一个最短连续子数组

`解法`

滑动窗口: 计算满足和大于目标值的最短子数组长度

## 语言

> 如何定义一个只能在堆上（栈上）生成对象的类？

`只能在堆上`

方法：将析构函数设置为私有

原因：C++ 是静态绑定语言，编译器管理栈上对象的生命周期，编译器在为类对象分配栈空间时，会先检查类的析构函数的访问性。若析构函数不可访问，则不能在栈上创建对象。

---

`只能在栈上`

方法：将 new 和 delete 重载为私有

原因：在堆上生成对象，使用 new 关键词操作，其过程分为两阶段：第一阶段，使用 new 在堆上寻找可用内存，分配给对象；第二阶段，调用构造函数生成对象。将 new 操作设置为私有，那么第一阶段就无法完成，就不能够在堆上生成对象。

## 基础知识

> 进程上下文切换

上下文切换主要干两件事情，一是切换进程空间，也即虚拟内存；二是切换寄存器和 CPU 上下文。

- 1、切换页表全局目录
- 2、切换内核态堆栈
- 3、切换硬件上下文（进程恢复前，必须装入寄存器的数据统称为硬件上下文）
    - ip(instruction pointer)：指向当前执行指令的下一条指令
    - bp(base pointer): 用于存放执行中的函数对应的栈帧的栈底地址
    - sp(stack poinger): 用于存放执行中的函数对应的栈帧的栈顶地址
    - cr3:页目录基址寄存器，保存页目录表的物理地址
- 4、刷新TLB
- 5、系统调度器的代码执行

所谓的进程切换，就是将某个进程的 thread_struct 里面的寄存器的值，写入到 CPU 的 TR 指向的 tss_struct，对于 CPU 来讲，这就算是完成了切换。

查看进程的运行时间: `ps -o etime= -p [进程id]`

查看进程的上下文切换次数: `grep ctxt /proc/[pid]/status`, 其中volutary_ctxt_switches表示主动调度的次数，nonvolutary_ctxt_switches表示抢占式调度的次数